@model ZeiterfassungViewModel
@{
    ViewData["Title"] = "Zeiterfassung";
    Layout = null; 
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="~/css/dashboard.css" />
    <title>STC - Dashboard</title>
</head>
<body>
<div class="sidebar">
    <div class="sidebar-header">
        <h2>Small Tech<br><span class="offset">&amp; Company</span></h2>
        <p class="time-manager-text">TimeManager</p>
            
        <div class="search">
            <input type="text" placeholder="Search...">
        </div>
    </div>

    <div class="sidebar-nav">
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">Roles</a></li>
            <li><a href="#">Vacation Time</a></li>
            <li><a href="#">Settings</a></li>
        </ul>
    </div>
    <div class="logout">
        <a class="logout-link nav-link" asp-area="" asp-controller="Account" asp-action="Logout">
            <i class="fas fa-sign-out-alt me-2"></i> Log out
        </a>
    </div>
</div>


<div class="main-content">
    <div class="topbar">
        <div class="topbar-right">
            <button class="notification-btn" title="Notifications">
                <div class="icon-btn">
                    <div class="icon-notif"></div>
                </div>
            </button>
            <div class="user-info">     
                <div class="user-details">
                    <p class="user-welcome">Welcome back,</p>
                    <h5>Adm_Username</h5>
                </div>
            </div>
        </div>
    </div>
    <div class="content-area">
        <div class="datetime">
            <h2>Today, @DateTime.Now.ToString("MMM d, yyyy")</h2>
        </div>
        <div class="stats-row">
            <div class="stat-card dark-gradient">
                <div class="stat-content">
                    <p class="stat-label">Active Employees</p>
                    <h3 class="stat-value">140</h3>
                </div>
                <div class="stat-icon">
                    <div class="icon-work"></div>
                </div>
            </div>

            <div class="stat-card dark-gradient">
                <div class="stat-content">
                    <p class="stat-label">Hours worked</p>
                    <h3 class="stat-value">3,279</h3>
                </div>
                <div class="stat-icon">
                    <div class="icon-clock"></div>
                </div>
            </div>

            <div class="stat-card dark-gradient">
                <div class="stat-content">
                    <p class="stat-label">Meetings scheduled</p>
                    <h3 class="stat-value">4</h3>
                </div>
                <div class="stat-icon">
                    <div class="icon-piechart"></div>
                </div>
            </div>
            <div class="stat-card dark-gradient">
                <div class="stat-content">
                    <p class="stat-label">Meetings scheduled</p>
                    <h3 class="stat-value">4</h3>
                </div>
                <div class="stat-icon">
                    <div class="icon-sun"></div>
                </div>
            </div>
        </div>
        <div class="chart-stats">
            <h2 class="chart-header">Working hours Overview</h2>
            <div class="chart-content"></div>
        </div>  
        <div class="time-tracking-major-disclaimer">
            <img src="~/Assets/warning-sign.png">
            <p class="time-tracking-disclaimer-text"><strong>DISCLAIMER:</strong> For the Company's Integrity & Trust, entries on the database <strong>can not be deleted.</strong>
                for any incorrect entries please contact the HR or your team supervisor.</p>
        </div>
        
        <div class="time-tracking-section">
            <div class="time-input-card">
                <h3 class="section-title">Time tracking input</h3>
        
                <form asp-area="Zeiterfassung" asp-controller="Zeiterfassung" asp-action="AddTimeEntry" method="post">
                    <div class="time-inputs-row">
                        <div class="input-group">
                            <label asp-for="InputStartTime">Start time</label>
                            <input asp-for="InputStartTime" type="time" class="time-input" />
                            <span asp-validation-for="InputStartTime" class="text-danger"></span>
                        </div>
                
                        <div class="input-group">
                            <label asp-for="InputEndTime">End time</label>
                            <input asp-for="InputEndTime" type="time" class="time-input" />
                            <span asp-validation-for="InputEndTime" class="text-danger"></span>
                        </div>
                    </div>
            
                    <div class="input-group full-width">
                        <label asp-for="InputDescription">Description</label>
                        <textarea asp-for="InputDescription" class="description-input" placeholder="Enter 'break' for break time or 'overtime' for overtime..."></textarea>
                    </div>
            
                    <button type="submit" class="enter-btn">Enter</button>
                </form>
            </div>
    
            <div class="today-working-card">
                <h3 class="section-title">Today's working time</h3>
        
                <table class="time-table">
                    <thead>
                    <tr>
                        <th>Category</th>
                        <th>Time span</th>
                        <th>Hours worked</th>
                    </tr>
                    </thead>
                    <tbody>
                    @if (Model.TodaysEntries != null && Model.TodaysEntries.Any())
                    {
                        @foreach (var entry in Model.TodaysEntries)
                        {
                            <tr class="@GetCategoryClass(entry.Category)">
                                <td>@entry.Category</td>
                                <td>@entry.TimeSpan</td>
                                <td>@entry.Hours.ToString("0.0") Hours</td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="3" style="text-align: center; padding: 20px; color: #9ca3af;">
                                No entries yet. Start tracking your time!
                            </td>
                        </tr>
                    }
                    </tbody>
                </table>
        
                <div class="total-hours">
                    <span class="total-label">Total hours worked:</span>
                    <span class="total-value">@Model.TodaysTotalHours.ToString("0.0") hours</span>
                </div>
            </div>
        </div>
    </div>
</div>
</body>

@functions {
    private string GetCategoryClass(string category)
    {
        return category?.ToLower() switch
        {
            "working time" => "working-time",
            "break time" => "break-time",
            "overtime" => "overtime",
            _ => "working-time"
        };
    }
}
